<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¯Ø§Ø±Ùƒ - Ø§Ù„Ø­Ø¶ÙˆØ±</title>
    <link rel="stylesheet" href="Style.css">
    <link href="https://fonts.googleapis.com/css?family=Cairo&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://unpkg.com/jspdf-arabic@1.0.0/dist/jspdf.arabic.min.js"></script>
    <style>
        .attendance-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            gap: 1rem;
        }
        .attendance-icon {
            font-size: 2rem;
            color: #4068fc;
        }
        .attendance-title {
            font-size: 1.5rem;
            color: #4068fc;
            font-weight: bold;
        }
        .student-info {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .info-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .info-label {
            color: #666;
            font-weight: 500;
        }
        .info-value {
            color: #4068fc;
            font-weight: bold;
        }
        .filters-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .filter-label {
            color: #666;
            font-weight: 500;
        }
        .filter-input {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: inherit;
        }
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }
        .attendance-table th {
            background: #4068fc;
            color: white;
            padding: 1rem;
            text-align: center;
            font-weight: 500;
        }
        .attendance-table td {
            padding: 0.8rem;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        .attendance-table tr:last-child td {
            border-bottom: none;
        }
        .weekend {
            background: #f8f9fa;
        }
        .status-present {
            color: #28a745;
        }
        .status-late {
            color: #ffc107;
        }
        .status-excused {
            color: #17a2b8;
        }
        .attendance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .summary-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }
        .summary-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4068fc;
            margin: 0.5rem 0;
        }
        .summary-label {
            color: #666;
            font-weight: 500;
        }
        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
            max-width: 400px;
            margin: 0 auto 2rem auto;
        }
        .icons-legend {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .legend-icon {
            font-size: 1.2rem;
        }
        .legend-text {
            color: #666;
            font-size: 0.9rem;
        }
        .export-btn {
            background: #4068fc;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }
        .export-btn:hover {
            background: #43cea2;
        }
        @media (max-width: 768px) {
            .student-info {
                flex-direction: column;
                gap: 1rem;
            }
            .filters-container {
                flex-direction: column;
            }
            .attendance-table {
                display: block;
                overflow-x: auto;
            }
        }
        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }
        .calendar-table th {
            background: #4068fc;
            color: white;
            padding: 1rem;
            text-align: center;
            font-weight: 500;
        }
        .calendar-table td {
            padding: 1rem;
            text-align: center;
            border: 1px solid #eee;
            position: relative;
            min-width: 80px;
            height: 80px;
            vertical-align: top;
        }
        .calendar-table .weekend {
            background: #f8f9fa;
        }
        .calendar-table .day-number {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        .calendar-table .status-icon {
            font-size: 1.5rem;
            margin-top: 1.5rem;
        }
        .calendar-table .empty-cell {
            background: #f8f9fa;
        }
        .calendar-table .today {
            background: rgba(64, 104, 252, 0.1);
            border: 2px solid #4068fc;
        }
        .calendar-table .today .day-number {
            color: #4068fc;
            font-weight: bold;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .calendar-title {
            font-size: 1.2rem;
            color: #4068fc;
            font-weight: bold;
        }
        .calendar-nav {
            display: flex;
            gap: 1rem;
        }
        .calendar-nav-btn {
            background: #4068fc;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
        }
        .calendar-nav-btn:hover {
            background: #43cea2;
        }
        .calendar-nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="student-header">
        <button class="sidebar-toggle" id="sidebarToggle" title="Ø¥ØºÙ„Ø§Ù‚/ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">&#9776;</button>
        <div class="student-header-left">
            <span class="student-title">Ø§Ù„Ø­Ø¶ÙˆØ±</span>
        </div>
        <div class="student-header-right">
            <span class="student-notifications" title="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª" style="cursor:pointer; font-size: 1.3em; margin: 0 8px; position: relative;">
                ğŸ””
                <span id="notification-count" style="display:none; position: absolute; top: -8px; right: -8px; background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.8em; min-width: 18px; text-align: center;">0</span>
            </span>
            <span class="student-messages" title="Ø§Ù„Ù†Ù‚Ø§Ø´Ø§Øª" style="cursor:pointer; font-size: 1.3em; margin-left: 8px; position: relative;" onclick="window.location.href='Student_Discussion.html'">
                ğŸ’¬
                <span id="message-count" style="display:none; position: absolute; top: -8px; right: -8px; background: #2196f3; color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.8em; min-width: 18px; text-align: center;">0</span>
            </span>
            <span class="student-user">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø§Ù„Ø·Ø§Ù„Ø¨</span>
            <button class="logout-btn">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    <div class="student-sidebar">
        <h2 class="sidebar-title">Ù…Ø¯Ø§Ø±ÙÙƒ</h2>
        <button class="sidebar-toggle sidebar-toggle-inside" id="sidebarToggleInside" title="Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©" style="display:none">&#10005;</button>
        <ul>
            <li><a href="StudentDashboard.html" id="dashboard-link"><span class="icon">ğŸ </span> Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª </a></li>
            <li><a href="Student_Lessons.html" id="courses-link"><span class="icon">ğŸ“š</span> Ø¯Ø±ÙˆØ³ÙŠ </a></li>
            <li><a href="Student_Homework.html" id="assignments-link"><span class="icon">ğŸ“</span> ÙˆØ§Ø¬Ø¨Ø§ØªÙŠ </a></li>
            <li><a href="Student_Grades.html" id="grades-link"><span class="icon">ğŸ“Š</span> Ø¯Ø±Ø¬Ø§ØªÙŠ</a></li>
            <li><a href="Student_Attendance.html" id="attendance-link" class="active"><span class="icon">ğŸ“…</span> Ø§Ù„Ø­Ø¶ÙˆØ±</a></li>
            <li><a href="Student_Courses.html" id="courses-link"><span class="icon">ğŸ‘¨â€ğŸ«</span> Ø§Ù„Ø¯ÙˆØ±Ø§Øª </a></li>
        </ul>
    </div>
    <div class="student-main" id="student-main-content">
        <div class="attendance-header">
            <span class="attendance-icon">ğŸ“…</span>
            <span class="attendance-title">Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±</span>
        </div>

        <div class="student-info">
            <div class="info-item">
                <span class="info-label">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</span>
                <span class="info-value" id="student-name">Ø³Ø±Ø§Ø¬ Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ø¹Ø±ÙŠØ¨ÙŠ</span>
            </div>
            <div class="info-item">
                <span class="info-label">Ø§Ù„ØµÙ:</span>
                <span class="info-value" id="student-grade">Ø§Ù„Ø³Ø§Ø¯Ø³</span>
            </div>
            <div class="info-item">
                <span class="info-label">Ø§Ù„ÙØµÙ„:</span>
                <span class="info-value" id="student-class">Ø£</span>
            </div>
        </div>

        <div class="filters-container">
            <div class="filter-group">
                <label class="filter-label">Ø§Ù„Ø´Ù‡Ø±:</label>
                <select class="filter-input" id="month-filter">
                    <option value="9-2024">Ø³Ø¨ØªÙ…Ø¨Ø± 2024</option>
                    <option value="10-2024">Ø£ÙƒØªÙˆØ¨Ø± 2024</option>
                    <option value="11-2024">Ù†ÙˆÙÙ…Ø¨Ø± 2024</option>
                    <option value="12-2024">Ø¯ÙŠØ³Ù…Ø¨Ø± 2024</option>
                    <option value="1-2025">ÙŠÙ†Ø§ÙŠØ± 2025</option>
                    <option value="2-2025">ÙØ¨Ø±Ø§ÙŠØ± 2025</option>
                    <option value="3-2025">Ù…Ø§Ø±Ø³ 2025</option>
                    <option value="4-2025">Ø£Ø¨Ø±ÙŠÙ„ 2025</option>
                    <option value="5-2025" selected>Ù…Ø§ÙŠÙˆ 2025</option>
                </select>
            </div>
        </div>

        <div class="calendar-header">
            <div class="calendar-title" id="calendar-title">Ù…Ø§ÙŠÙˆ 2025</div>
            <div class="calendar-nav">
                <button class="calendar-nav-btn" onclick="previousMonth()" id="prev-month-btn">Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                <button class="calendar-nav-btn" onclick="nextMonth()" id="next-month-btn">Ø§Ù„Ø´Ù‡Ø± Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>
        </div>

        <div class="icons-legend">
            <div class="legend-item">
                <span class="legend-icon">âœ…</span>
                <span class="legend-text">Ø­Ø§Ø¶Ø±</span>
            </div>
            <div class="legend-item">
                <span class="legend-icon">âŒ</span>
                <span class="legend-text">ØºØ§Ø¦Ø¨</span>
            </div>
            <div class="legend-item">
                <span class="legend-icon">â°</span>
                <span class="legend-text">Ù…ØªØ£Ø®Ø±</span>
            </div>
            <div class="legend-item">
                <span class="legend-icon">ğŸ“„</span>
                <span class="legend-text">Ø¨Ø¹Ø°Ø±</span>
            </div>
        </div>

        <table class="calendar-table">
            <thead>
                <tr>
                    <th>Ø§Ù„Ø£Ø­Ø¯</th>
                    <th>Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</th>
                    <th>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</th>
                    <th>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</th>
                    <th>Ø§Ù„Ø®Ù…ÙŠØ³</th>
                    <th>Ø§Ù„Ø¬Ù…Ø¹Ø©</th>
                    <th>Ø§Ù„Ø³Ø¨Øª</th>
                </tr>
            </thead>
            <tbody id="calendar-body">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </tbody>
        </table>

        <button class="export-btn" onclick="exportToPDF()">
            <span>ğŸ“„</span>
            <span>ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ PDF</span>
        </button>

        <div class="attendance-summary">
            <div class="summary-card">
                <div class="summary-value" id="present-days">0</div>
                <div class="summary-label">Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±</div>
            </div>
            <div class="summary-card">
                <div class="summary-value" id="absent-days">0</div>
                <div class="summary-label">Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨</div>
            </div>
            <div class="summary-card">
                <div class="summary-value" id="late-days">0</div>
                <div class="summary-label">Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ±</div>
            </div>
            <div class="summary-card">
                <div class="summary-value" id="excused-days">0</div>
                <div class="summary-label">Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨ Ø¨Ø¹Ø°Ø±</div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="attendance-chart"></canvas>
        </div>
    </div>
    <script src="Script.js"></script>
    <script>
        /**
         * ØªÙˆØ«ÙŠÙ‚ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù€ API Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ù€ Backend Team
         * 
         * 1. Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:
         * 
         * Ø£. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨:
         * {
         *     id: string,          // Ù…Ø¹Ø±Ù Ø§Ù„Ø·Ø§Ù„Ø¨
         *     name: string,        // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ù„Ù„Ø·Ø§Ù„Ø¨
         *     grade: string,       // Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
         *     class: string        // Ø§Ù„ÙØµÙ„
         * }
         * 
         * Ø¨. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±:
         * {
         *     date: string,        // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¶ÙˆØ± (YYYY-MM-DD)
         *     status: string,      // Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¶ÙˆØ± (present, absent, late, excused)
         *     recorded_by: string, // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
         *     recorded_at: string, // ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (ISO 8601)
         *     notes: string        // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
         * }
         * 
         * 2. Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© API Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
         * 
         * Ø£. Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨:
         * GET /api/students/{studentId}
         * Response: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
         * 
         * Ø¨. Ø¬Ù„Ø¨ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±:
         * GET /api/attendance/{studentId}
         * Query Parameters:
         *   - month: Ø±Ù‚Ù… Ø§Ù„Ø´Ù‡Ø± (1-12)
         *   - year: Ø§Ù„Ø³Ù†Ø©
         * Response: Ù…ØµÙÙˆÙØ© Ù…Ù† Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±
         * 
         * Ø¬. ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø¬Ø¯ÙŠØ¯:
         * POST /api/attendance
         * Body: Ø³Ø¬Ù„ Ø­Ø¶ÙˆØ± Ø¬Ø¯ÙŠØ¯
         * Response: Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø­Ø¯Ø«
         * 
         * Ø¯. ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„ Ø­Ø¶ÙˆØ±:
         * PUT /api/attendance/{attendanceId}
         * Body: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«
         * Response: Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø­Ø¯Ø«
         * 
         * 3. Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†:
         * - ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¨Ù„ Ø£ÙŠ Ø¹Ù…Ù„ÙŠØ©
         * - ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©
         * - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©
         * 
         * 4. Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù‡Ø§Ù…Ø©:
         * - ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø¶Ù…Ù† Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
         * - ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ…
         * - ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ ÙˆÙ‚Øª ÙˆØªØ§Ø±ÙŠØ® ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ© ØªØ¹Ø¯ÙŠÙ„
         * - ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³Ø¬Ù„ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª (audit log)
         */

        // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© (ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¨Ø§Ùƒ Ø¥Ù†Ø¯)
        function generateMockAttendanceData() {
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            const attendance = [];
            let absentDay = Math.floor(Math.random() * daysInMonth) + 1;
            let lateDay = Math.floor(Math.random() * daysInMonth) + 1;
            let excusedDay = Math.floor(Math.random() * daysInMonth) + 1;
            
            // ØªØ¬Ù†Ø¨ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø£ÙŠØ§Ù…
            while (lateDay === absentDay) {
                lateDay = Math.floor(Math.random() * daysInMonth) + 1;
            }
            while (excusedDay === absentDay || excusedDay === lateDay) {
                excusedDay = Math.floor(Math.random() * daysInMonth) + 1;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                const dayName = date.toLocaleDateString('ar-SA', { weekday: 'long' });
                
                // ØªØ®Ø·ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ø·Ù„Ø© (Ø§Ù„Ø¬Ù…Ø¹Ø© ÙˆØ§Ù„Ø³Ø¨Øª)
                if (dayName === 'Ø§Ù„Ø¬Ù…Ø¹Ø©' || dayName === 'Ø§Ù„Ø³Ø¨Øª') {
                    continue;
                }

                let status = 'present';
                if (day === absentDay) {
                    status = 'absent';
                } else if (day === lateDay) {
                    status = 'late';
                } else if (day === excusedDay) {
                    status = 'excused';
                }
                
                const record = {
                    date: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`,
                    status: status,
                    recorded_by: "ADM001",
                    recorded_at: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}T08:00:00`,
                    notes: getStatusNote(status)
                };
                
                attendance.push(record);
            }
            
            return {
                student: {
                    id: "STU001",
                    name: "Ø³Ø±Ø§Ø¬ Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ø¹Ø±ÙŠØ¨ÙŠ",
                    grade: "Ø§Ù„Ø³Ø§Ø¯Ø³",
                    class: "Ø£"
                },
                attendance: attendance
            };
        }

        function getStatusNote(status) {
            const notes = {
                present: "",
                late: "ØªØ£Ø®Ø± " + Math.floor(Math.random() * 20 + 5) + " Ø¯Ù‚Ø§Ø¦Ù‚",
                excused: ["Ø¹Ø°Ø± Ø·Ø¨ÙŠ", "Ø¹Ø°Ø± Ø¹Ø§Ø¦Ù„ÙŠ", "Ù…ÙˆØ¹Ø¯ Ø·Ø¨ÙŠØ¨", "Ù…Ù†Ø§Ø³Ø¨Ø© Ø®Ø§ØµØ©"][Math.floor(Math.random() * 4)],
                absent: "ØºÙŠØ§Ø¨ Ø¨Ø¯ÙˆÙ† Ø¹Ø°Ø±"
            };
            return notes[status];
        }

        const mockAttendanceData = generateMockAttendanceData();

        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
        document.getElementById('student-name').textContent = mockAttendanceData.student.name;
        document.getElementById('student-grade').textContent = mockAttendanceData.student.grade;
        document.getElementById('student-class').textContent = mockAttendanceData.student.class;

        /**
         * Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
         * 
         * Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„Ù€ Backend:
         * - ÙŠØ¬Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ø·Ù„Ø¨ API
         * - ÙŠØ¬Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø®Ø·Ø£ (Ù…Ø«Ù„ Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„)
         * - ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± ØªØ­Ù…ÙŠÙ„ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
         * - ÙŠØ¬Ø¨ ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡
         */
        function updateCalendar() {
            const tbody = document.getElementById('calendar-body');
            tbody.innerHTML = '';

            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const startingDay = firstDay.getDay();
            const totalDays = lastDay.getDate();
            const today = new Date();

            // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            const totalRows = Math.ceil((startingDay + totalDays) / 7);

            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ
            for (let row = 0; row < totalRows; row++) {
                const tr = document.createElement('tr');
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ ÙÙŠ ÙƒÙ„ ØµÙ
                for (let col = 0; col < 7; col++) {
                    const td = document.createElement('td');
                    const dayNumber = row * 7 + col - startingDay + 1;

                    if (dayNumber > 0 && dayNumber <= totalDays) {
                        // Ø¥Ù†Ø´Ø§Ø¡ Ø®Ù„ÙŠØ© Ù„Ù„ÙŠÙˆÙ…
                        const currentDate = new Date(currentYear, currentMonth, dayNumber);
                        const dayName = currentDate.toLocaleDateString('ar-SA', { weekday: 'long' });

                        // ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
                        if (currentDate.toDateString() === today.toDateString()) {
                            td.classList.add('today');
                        }

                        // ØªÙ…ÙŠÙŠØ² Ø¹Ø·Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
                        if (dayName === 'Ø§Ù„Ø¬Ù…Ø¹Ø©' || dayName === 'Ø§Ù„Ø³Ø¨Øª') {
                            td.classList.add('weekend');
                        }

                        // Ø¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ…
                        const dayNumberDiv = document.createElement('div');
                        dayNumberDiv.className = 'day-number';
                        dayNumberDiv.textContent = dayNumber;
                        td.appendChild(dayNumberDiv);

                        // Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¶ÙˆØ±
                        const attendanceRecord = mockAttendanceData.attendance.find(
                            a => {
                                const recordDate = new Date(a.date);
                                return recordDate.getDate() === dayNumber &&
                                       recordDate.getMonth() === currentMonth &&
                                       recordDate.getFullYear() === currentYear;
                            }
                        );

                        if (attendanceRecord) {
                            const statusIcon = document.createElement('div');
                            statusIcon.className = 'status-icon';
                            
                            const statusIconMap = {
                                present: 'âœ…',
                                absent: 'âŒ',
                                late: 'â°',
                                excused: 'ğŸ“„'
                            };

                            const statusClassMap = {
                                present: 'status-present',
                                absent: 'status-absent',
                                late: 'status-late',
                                excused: 'status-excused'
                            };

                            statusIcon.textContent = statusIconMap[attendanceRecord.status];
                            statusIcon.classList.add(statusClassMap[attendanceRecord.status]);
                            td.appendChild(statusIcon);
                        }
                    } else {
                        // Ø¥Ù†Ø´Ø§Ø¡ Ø®Ù„ÙŠØ© ÙØ§Ø±ØºØ©
                        td.classList.add('empty-cell');
                    }
                    
                    tr.appendChild(td);
                }
                
                tbody.appendChild(tr);
            }

            updateCalendarTitle();
            updateNavigationButtons();
            updateMonthFilter();
        }

        /**
         * Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø¶ÙˆØ±
         * 
         * Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„Ù€ Backend:
         * - ÙŠØ¬Ø¨ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙŠ Ø§Ù„Ù€ Backend
         * - ÙŠØ¬Ø¨ ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ø¤Ù‚ØªØ§Ù‹
         * - ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
         */
        function updateAttendanceSummary() {
            // ØªØµÙÙŠØ© Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙ‚Ø·
            const currentMonthAttendance = mockAttendanceData.attendance.filter(record => {
                const recordDate = new Date(record.date);
                return recordDate.getMonth() === currentMonth && 
                       recordDate.getFullYear() === currentYear;
            });

            const summary = {
                present: currentMonthAttendance.filter(a => a.status === "present").length,
                absent: currentMonthAttendance.filter(a => a.status === "absent").length,
                late: currentMonthAttendance.filter(a => a.status === "late").length,
                excused: currentMonthAttendance.filter(a => a.status === "excused").length
            };

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
            document.getElementById('present-days').textContent = summary.present;
            document.getElementById('absent-days').textContent = summary.absent;
            document.getElementById('late-days').textContent = summary.late;
            document.getElementById('excused-days').textContent = summary.excused;

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
            const ctx = document.getElementById('attendance-chart').getContext('2d');
            
            if (window.attendanceChart) {
                window.attendanceChart.destroy();
            }

            window.attendanceChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Ø­Ø§Ø¶Ø±', 'ØºØ§Ø¦Ø¨', 'Ù…ØªØ£Ø®Ø±', 'Ø¨Ø¹Ø°Ø±'],
                    datasets: [{
                        data: [summary.present, summary.absent, summary.late, summary.excused],
                        backgroundColor: ['#28a745', '#dc3545', '#ffc107', '#17a2b8']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: `Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ± - ${getMonthName(currentMonth)} ${currentYear}`,
                            font: {
                                size: 16
                            }
                        }
                    }
                }
            });
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø´Ù‡Ø±
        function getMonthName(month) {
            const monthNames = [
                "ÙŠÙ†Ø§ÙŠØ±", "ÙØ¨Ø±Ø§ÙŠØ±", "Ù…Ø§Ø±Ø³", "Ø£Ø¨Ø±ÙŠÙ„", "Ù…Ø§ÙŠÙˆ", "ÙŠÙˆÙ†ÙŠÙˆ",
                "ÙŠÙˆÙ„ÙŠÙˆ", "Ø£ØºØ³Ø·Ø³", "Ø³Ø¨ØªÙ…Ø¨Ø±", "Ø£ÙƒØªÙˆØ¨Ø±", "Ù†ÙˆÙÙ…Ø¨Ø±", "Ø¯ÙŠØ³Ù…Ø¨Ø±"
            ];
            return monthNames[month];
        }

        /**
         * Ø¯Ø§Ù„Ø© ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ PDF
         */
        function exportToPDF() {
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù…Ø¤Ù‚Øª Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                const firstPageDiv = document.createElement('div');
                firstPageDiv.style.direction = 'rtl';
                firstPageDiv.style.padding = '20px';
                firstPageDiv.style.backgroundColor = 'white';
                firstPageDiv.style.width = '800px';
                firstPageDiv.style.margin = '0 auto';
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                firstPageDiv.innerHTML = `
                    <h1 style="text-align: center; color: #4068fc; margin-bottom: 30px;">Ù…Ø¯Ø§Ø±Ùƒ - ÙƒØ´Ù Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</h1>
                    <div style="margin: 20px 0; font-size: 16px;">
                        <p><strong>Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> ${mockAttendanceData.student.name}</p>
                        <p><strong>Ø§Ù„ØµÙ:</strong> ${mockAttendanceData.student.grade}</p>
                        <p><strong>Ø§Ù„ÙØµÙ„:</strong> ${mockAttendanceData.student.class}</p>
                        <p><strong>Ø§Ù„Ø´Ù‡Ø±:</strong> ${getMonthName(currentMonth)} ${currentYear}</p>
                    </div>
                `;

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                const currentMonthAttendance = mockAttendanceData.attendance.filter(record => {
                    const recordDate = new Date(record.date);
                    return recordDate.getMonth() === currentMonth && 
                           recordDate.getFullYear() === currentYear;
                });

                const summary = {
                    present: currentMonthAttendance.filter(a => a.status === "present").length,
                    absent: currentMonthAttendance.filter(a => a.status === "absent").length,
                    late: currentMonthAttendance.filter(a => a.status === "late").length,
                    excused: currentMonthAttendance.filter(a => a.status === "excused").length
                };

                firstPageDiv.innerHTML += `
                    <div style="margin-bottom: 30px;">
                        <h2 style="color: #4068fc; margin-bottom: 15px;">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ±</h2>
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                            <tr style="background-color: #4068fc; color: white;">
                                <th style="padding: 12px; border: 1px solid #ddd;">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¶ÙˆØ±</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</th>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Ø­Ø§Ø¶Ø±</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.present}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">ØºØ§Ø¦Ø¨</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.absent}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Ù…ØªØ£Ø®Ø±</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.late}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Ø¨Ø¹Ø°Ø±</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.excused}</td>
                            </tr>
                        </table>
                    </div>
                `;

                // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù…Ø¤Ù‚Øª Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
                const secondPageDiv = document.createElement('div');
                secondPageDiv.style.direction = 'rtl';
                secondPageDiv.style.padding = '20px';
                secondPageDiv.style.backgroundColor = 'white';
                secondPageDiv.style.width = '800px';
                secondPageDiv.style.margin = '0 auto';

                // ØªÙ‚Ø³ÙŠÙ… Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±
                const statusMap = {
                    'present': 'Ø­Ø§Ø¶Ø±',
                    'absent': 'ØºØ§Ø¦Ø¨',
                    'late': 'Ù…ØªØ£Ø®Ø±',
                    'excused': 'Ø¨Ø¹Ø°Ø±'
                };

                // Ø§Ù„Ø£ÙŠØ§Ù… Ù…Ù† 1 Ø¥Ù„Ù‰ 10
                const firstPageRows = currentMonthAttendance
                    .filter(record => {
                        const date = new Date(record.date);
                        return date.getDate() <= 10;
                    })
                    .map(record => {
                        const date = new Date(record.date);
                        return `
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getDate()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${getMonthName(date.getMonth())}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getFullYear()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.status === 'holiday' ? '-' : statusMap[record.status]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.notes || '-'}</td>
                            </tr>
                        `;
                    }).join('');

                // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£ÙŠØ§Ù…
                const secondPageRows = currentMonthAttendance
                    .filter(record => {
                        const date = new Date(record.date);
                        return date.getDate() > 10;
                    })
                    .map(record => {
                        const date = new Date(record.date);
                        return `
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getDate()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${getMonthName(date.getMonth())}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getFullYear()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.status === 'holiday' ? '-' : statusMap[record.status]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.notes || '-'}</td>
                            </tr>
                        `;
                    }).join('');

                // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£ÙŠØ§Ù… Ù…Ù† 1 Ø¥Ù„Ù‰ 10 Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                firstPageDiv.innerHTML += `
                    <div style="margin-bottom: 30px;">
                        <h2 style="color: #4068fc; margin-bottom: 15px;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± (1-10)</h2>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr style="background-color: #4068fc; color: white;">
                                <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„ÙŠÙˆÙ…</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„Ø´Ù‡Ø±</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„Ø³Ù†Ø©</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                            </tr>
                            ${firstPageRows}
                        </table>
                    </div>
                `;

                // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
                secondPageDiv.innerHTML = `
                    <h2 style="color: #4068fc; margin-bottom: 15px;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± (11-31)</h2>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="background-color: #4068fc; color: white;">
                            <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„ÙŠÙˆÙ…</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„Ø´Ù‡Ø±</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„Ø³Ù†Ø©</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                        </tr>
                        ${secondPageRows}
                    </table>
                    <div style="text-align: center; margin-top: 30px; color: #666; font-size: 14px;">
                        ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙŠ ${new Date().toLocaleDateString('ar')}
                    </div>
                `;

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
                document.body.appendChild(firstPageDiv);
                document.body.appendChild(secondPageDiv);

                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ù„Ù‰ ØµÙˆØ±Ø©
                html2canvas(firstPageDiv, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    windowWidth: firstPageDiv.scrollWidth,
                    windowHeight: firstPageDiv.scrollHeight
                }).then(canvas1 => {
                    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ø¥Ù„Ù‰ ØµÙˆØ±Ø©
                    html2canvas(secondPageDiv, {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        windowWidth: secondPageDiv.scrollWidth,
                        windowHeight: secondPageDiv.scrollHeight
                    }).then(canvas2 => {
                        const { jsPDF } = window.jspdf;
                        const pdf = new jsPDF('p', 'mm', 'a4');
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                        const imgData1 = canvas1.toDataURL('image/png');
                        const pdfHeight1 = (canvas1.height * pdfWidth) / canvas1.width;
                        pdf.addImage(imgData1, 'PNG', 0, 0, pdfWidth, pdfHeight1);
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
                        const imgData2 = canvas2.toDataURL('image/png');
                        const pdfHeight2 = (canvas2.height * pdfWidth) / canvas2.width;
                        pdf.addPage();
                        pdf.addImage(imgData2, 'PNG', 0, 0, pdfWidth, pdfHeight2);

                        // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù
                        pdf.save(`Ø­Ø¶ÙˆØ±_${mockAttendanceData.student.name}_${getMonthName(currentMonth)}_${currentYear}.pdf`);
                        
                        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¤Ù‚ØªØ©
                        document.body.removeChild(firstPageDiv);
                        document.body.removeChild(secondPageDiv);
                    });
                });
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
            }
        }

        // ØªØ¹Ø±ÙŠÙ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
        const academicYear = {
            start: { month: 8, year: 2024 }, // Ø³Ø¨ØªÙ…Ø¨Ø± 2024
            end: { month: 4, year: 2025 }    // Ù…Ø§ÙŠÙˆ 2025
        };

        let currentMonth = 4; // Ù…Ø§ÙŠÙˆ (0-11)
        let currentYear = 2025;

        // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
        function updateCalendarTitle() {
            const monthNames = [
                "ÙŠÙ†Ø§ÙŠØ±", "ÙØ¨Ø±Ø§ÙŠØ±", "Ù…Ø§Ø±Ø³", "Ø£Ø¨Ø±ÙŠÙ„", "Ù…Ø§ÙŠÙˆ", "ÙŠÙˆÙ†ÙŠÙˆ",
                "ÙŠÙˆÙ„ÙŠÙˆ", "Ø£ØºØ³Ø·Ø³", "Ø³Ø¨ØªÙ…Ø¨Ø±", "Ø£ÙƒØªÙˆØ¨Ø±", "Ù†ÙˆÙÙ…Ø¨Ø±", "Ø¯ÙŠØ³Ù…Ø¨Ø±"
            ];
            document.getElementById('calendar-title').textContent = 
                `${monthNames[currentMonth]} ${currentYear}`;
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
        function isWithinAcademicYear(month, year) {
            if (year < academicYear.start.year || year > academicYear.end.year) {
                return false;
            }
            if (year === academicYear.start.year && month < academicYear.start.month) {
                return false;
            }
            if (year === academicYear.end.year && month > academicYear.end.month) {
                return false;
            }
            return true;
        }

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„
        function updateNavigationButtons() {
            const prevButton = document.getElementById('prev-month-btn');
            const nextButton = document.getElementById('next-month-btn');
            
            prevButton.disabled = !isWithinAcademicYear(currentMonth - 1, currentYear);
            nextButton.disabled = !isWithinAcademicYear(currentMonth + 1, currentYear);
        }

        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚
        function previousMonth() {
            if (currentMonth === 0) {
                currentMonth = 11;
                currentYear--;
            } else {
                currentMonth--;
            }
            if (isWithinAcademicYear(currentMonth, currentYear)) {
                updateCalendar();
                updateMonthFilter();
            }
        }

        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„ØªØ§Ù„ÙŠ
        function nextMonth() {
            if (currentMonth === 11) {
                currentMonth = 0;
                currentYear++;
            } else {
                currentMonth++;
            }
            if (isWithinAcademicYear(currentMonth, currentYear)) {
                updateCalendar();
                updateMonthFilter();
            }
        }

        // ØªØ­Ø¯ÙŠØ« ÙÙ„ØªØ± Ø§Ù„Ø´Ù‡Ø±
        function updateMonthFilter() {
            const monthFilter = document.getElementById('month-filter');
            const value = `${currentMonth + 1}-${currentYear}`;
            monthFilter.value = value;
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ù‡Ø± Ù…Ù† Ø§Ù„ÙÙ„ØªØ±
        document.getElementById('month-filter').addEventListener('change', function() {
            const [month, year] = this.value.split('-');
            const newMonth = parseInt(month) - 1;
            const newYear = parseInt(year);
            if (isWithinAcademicYear(newMonth, newYear)) {
                currentMonth = newMonth;
                currentYear = newYear;
                updateCalendar();
                updateAttendanceSummary();
            }
        });

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            updateCalendar();
            updateAttendanceSummary();
        });
    </script>
</body>
</html>
