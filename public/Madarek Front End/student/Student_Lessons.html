<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¯Ø§Ø±Ùƒ - Ø¯Ø±ÙˆØ³ÙŠ</title>
    <link rel="stylesheet" href="Style.css">
    <link href="https://fonts.googleapis.com/css?family=Cairo&display=swap" rel="stylesheet">
</head>
<body>
    <div class="student-header">
        <button class="sidebar-toggle" id="sidebarToggle" title="Ø¥ØºÙ„Ø§Ù‚/ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">&#9776;</button>
        <div class="student-header-left">
            <span class="student-title">Ø¯Ø±ÙˆØ³ÙŠ</span>
        </div>
        <div class="student-header-right">
            <span class="student-notifications" title="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª" style="cursor:pointer; font-size: 1.3em; margin: 0 8px; position: relative;">
                ğŸ””
                <span id="notification-count" style="display:none; position: absolute; top: -8px; right: -8px; background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.8em; min-width: 18px; text-align: center;">0</span>
            </span>
            <span class="student-messages" title="Ø§Ù„Ù†Ù‚Ø§Ø´Ø§Øª" style="cursor:pointer; font-size: 1.3em; margin-left: 8px; position: relative;" onclick="window.location.href='Student_Discussion.html'">
                ğŸ’¬
                <span id="message-count" style="display:none; position: absolute; top: -8px; right: -8px; background: #2196f3; color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.8em; min-width: 18px; text-align: center;">0</span>
            </span>
            <span class="student-user">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø§Ù„Ø·Ø§Ù„Ø¨</span>
            <button class="logout-btn">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    <div class="student-sidebar">
        <h2 class="sidebar-title">Ù…Ø¯Ø§Ø±ÙÙƒ</h2>
        <button class="sidebar-toggle sidebar-toggle-inside" id="sidebarToggleInside" title="Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©" style="display:none">&#10005;</button>
        <ul>
            <li><a href="StudentDashboard.html" id="dashboard-link"><span class="icon">ğŸ </span> Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª </a></li>
            <li><a href="Student_Lessons.html" id="courses-link" class="active"><span class="icon">ğŸ“š</span> Ø¯Ø±ÙˆØ³ÙŠ </a></li>
            <li><a href="Student_Homework.html" id="assignments-link"><span class="icon">ğŸ“</span> ÙˆØ§Ø¬Ø¨Ø§ØªÙŠ </a></li>
            <li><a href="Student_Grades.html" id="grades-link"><span class="icon">ğŸ“Š</span> Ø¯Ø±Ø¬Ø§ØªÙŠ</a></li>
            <li><a href="Student_Attendance.html" id="attendance-link"><span class="icon">ğŸ“…</span> Ø§Ù„Ø­Ø¶ÙˆØ±</a></li>
            <li><a href="Student_Courses.html" id="courses-link"><span class="icon">ğŸ‘¨â€ğŸ«</span> Ø§Ù„Ø¯ÙˆØ±Ø§Øª </a></li>
        </ul>
    </div>
    <div class="student-main" id="student-main-content">
        <div class="lessons-header">
            <span class="lessons-icon">ğŸ“š</span>
            <span class="lessons-title">Ø¯Ø±ÙˆØ³ÙŠ</span>
        </div>
        <div class="lessons-grid-container">
            <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø¯ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø±Ø¨Ø¹ -->
        </div>
    </div>
    <script src="Script.js"></script>
    <script>
    // ==================== ÙƒÙˆØ¯ ØµÙØ­Ø© Ø¯Ø±ÙˆØ³ÙŠ (Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§Ø¯ ÙƒÙ…Ø±Ø¨Ø¹Ø§Øª) ====================
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø±ÙˆØ³ ÙƒÙ…Ø§ Ù‡ÙŠ
    const lessonsData = [
        { id: 1, subject: "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", title: "Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø®Ø·ÙŠØ©", date: "2025-05-20", completed: false, type: 'pdf', url: 'linear-equations.pdf' },
        { id: 2, subject: "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", title: "Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø£Ø¯Ø¨ÙŠØ© (ÙÙŠØ¯ÙŠÙˆ)", date: "2025-05-18", completed: true, type: 'video', url: 'arabic-poetry.mp4' },
        { id: 3, subject: "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø£Ù†Ø¬Ù„ÙŠØ²ÙŠØ©", title: "Grammar Basics (Ù†Øµ)", date: "2025-05-10", completed: false, type: 'text', content: 'Ø´Ø±Ø­ Ù…Ø¨Ø³Ø· Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©: Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø§Ø³Ù…ÙŠØ© ÙˆØ§Ù„ÙØ¹Ù„ÙŠØ©ØŒ Ø§Ù„Ø£Ø²Ù…Ù†Ø©ØŒ ÙˆØ£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­.' },
        { id: 4, subject: "Ø§Ù„Ø¹Ù„ÙˆÙ…", title: "Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù‡Ø¶Ù…ÙŠ (ØµÙˆØ±Ø©)", date: "2025-05-14", completed: true, type: 'image', url: 'digestive-system.png' },
        { id: 5, subject: "Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", title: "Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© (PDF)", date: "2025-05-05", completed: false, type: 'pdf', url: 'programming-intro.pdf' },
        { id: 6, subject: "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø£Ø³Ù„Ø§Ù…ÙŠØ©", title: "Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø© (ÙÙŠØ¯ÙŠÙˆ)", date: "2025-05-21", completed: false, type: 'video', url: 'alfatiha.mp4' },
        { id: 7, subject: "Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§", title: "Ø§Ù„Ù…Ù†Ø§Ø® ÙˆØ§Ù„Ø·Ù‚Ø³ (Ù†Øµ)", date: "2025-05-19", completed: false, type: 'text', content: 'ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ù†Ø§Ø® ÙˆØ§Ù„Ø·Ù‚Ø³ØŒ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ†Ù‡Ù…Ø§ØŒ ÙˆØ£Ù‡Ù…ÙŠØ© Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ø·Ù‚Ø³ ÙÙŠ Ø­ÙŠØ§ØªÙ†Ø§ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.' },
        { id: 8, subject: "Ø§Ù„ØªØ§Ø±ÙŠØ®", title: "Ø§Ù„Ø­Ø¶Ø§Ø±Ø© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© (ØµÙˆØ±Ø©)", date: "2025-05-13", completed: true, type: 'image', url: 'islamic-civilization.png' }
    ];

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ Ù…Ø¹ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª/Ø±Ø³ÙˆÙ…Ø§Øª ØªØ­ÙÙŠØ²ÙŠØ©
    const subjectsMeta = {
        "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª": { icon: "ğŸ§®", color: "#f7b731", bg: "#fffbe6" },
        "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©": { icon: "ğŸ“–", color: "#eb3b5a", bg: "#fff0f3" },
        "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø£Ù†Ø¬Ù„ÙŠØ²ÙŠØ©": { icon: "ğŸ‡¬ğŸ‡§", color: "#3867d6", bg: "#eaf0ff" },
        "Ø§Ù„Ø¹Ù„ÙˆÙ…": { icon: "ğŸ”¬", color: "#20bf6b", bg: "#eafff3" },
        "Ø§Ù„Ø­Ø§Ø³ÙˆØ¨": { icon: "ğŸ’»", color: "#8854d0", bg: "#f3eaff" },
        "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø£Ø³Ù„Ø§Ù…ÙŠØ©": { icon: "ğŸ•Œ", color: "#0fb9b1", bg: "#e6fffa" },
        "Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§": { icon: "ğŸŒ", color: "#fd9644", bg: "#fff7e6" },
        "Ø§Ù„ØªØ§Ø±ÙŠØ®": { icon: "ğŸº", color: "#a55eea", bg: "#f7eaff" }
    };

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…)
    function isNewLesson(dateStr) {
        const today = new Date();
        const lessonDate = new Date(dateStr);
        const diffDays = (today - lessonDate) / (1000 * 60 * 60 * 24);
        return diffDays <= 7;
    }

    // Ø­ÙØ¸ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„ØªÙŠ ØªÙ… Ø¹Ø±Ø¶Ù‡Ø§
    function markSubjectLessonsAsRead(subject, latestLessonDate) {
        let readSubjects = JSON.parse(localStorage.getItem('readSubjects') || '{}');
        readSubjects[subject] = latestLessonDate;
        localStorage.setItem('readSubjects', JSON.stringify(readSubjects));
    }
    function isSubjectRead(subject, latestLessonDate) {
        let readSubjects = JSON.parse(localStorage.getItem('readSubjects') || '{}');
        return readSubjects[subject] === latestLessonDate;
    }
    function renderSubjectsGrid() {
        const container = document.querySelector('.lessons-grid-container');
        container.innerHTML = '';
        Object.keys(subjectsMeta).forEach(subject => {
            const subjectLessons = lessonsData.filter(l => l.subject === subject);
            const newLessons = subjectLessons.filter(l => isNewItem(l.date));
            const latestNewLesson = newLessons.length ? newLessons.reduce((a, b) => new Date(a.date) > new Date(b.date) ? a : b).date : null;
            let badgeHtml = '';
            if (newLessons.length && !isSubjectRead('lessons', subject, latestNewLesson)) {
                badgeHtml = `<span class='subject-badge-new'>${newLessons.length} Ø¬Ø¯ÙŠØ¯</span>`;
            }
            let html = `<div class='subject-card' data-bg='${subject}' style='cursor:pointer;' data-latest='${latestNewLesson || ''}'>
                ${badgeHtml}
                <div class='subject-content'>
                    <span class='subject-icon' style='font-size:4.2rem;'>${subjectsMeta[subject].icon}</span>
                    <div class='subject-title'>${subject}</div>
                </div>
            </div>`;
            container.innerHTML += html;
        });
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ù†Ù‚Ø± Ø¨Ø¹Ø¯ Ø±Ø³Ù… Ø§Ù„ÙƒØ±ÙˆØª
        const cards = container.querySelectorAll('.subject-card');
        cards.forEach(card => {
            card.onclick = function() {
                const subject = card.querySelector('.subject-title').textContent;
                const latestNewLesson = card.getAttribute('data-latest');
                if (latestNewLesson) markSubjectAsRead('lessons', subject, latestNewLesson);
                localStorage.setItem('selectedSubject', subject);
                window.location.href = 'Student_Lessons_Subject.html';
            };
        });
    }

    // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯Ù‹Ø§
    function isNewItem(dateStr) {
        const today = new Date();
        const itemDate = new Date(dateStr);
        return (today - itemDate) / (1000 * 60 * 60 * 24) <= 7;
    }

    // Ø¯Ø§Ù„Ø© Ù„Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¯Ø±ÙˆØ³
    function markSubjectAsRead(type, subject, latestLessonDate) {
        let key = type + '_' + subject;
        localStorage.setItem(key, latestLessonDate);
    }

    // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø§Ø¯Ø© Ù…Ù‚Ø±ÙˆØ¡Ø©
    function isSubjectRead(type, subject, latestLessonDate) {
        let key = type + '_' + subject;
        let storedDate = localStorage.getItem(key);
        return storedDate === latestLessonDate;
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
    function init() {
        renderSubjectsGrid();
    }

    window.onload = init;
    </script>
</body>
</html>
