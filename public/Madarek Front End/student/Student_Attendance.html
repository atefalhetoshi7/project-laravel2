<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÖÿØÿßÿ±ŸÉ - ÿßŸÑÿ≠ÿ∂Ÿàÿ±</title>
    <link rel="stylesheet" href="Style.css">
    <link href="https://fonts.googleapis.com/css?family=Cairo&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://unpkg.com/jspdf-arabic@1.0.0/dist/jspdf.arabic.min.js"></script>
    <style>
        .attendance-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            gap: 1rem;
        }
        .attendance-icon {
            font-size: 2rem;
            color: #4068fc;
        }
        .attendance-title {
            font-size: 1.5rem;
            color: #4068fc;
            font-weight: bold;
        }
        .student-info {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .info-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .info-label {
            color: #666;
            font-weight: 500;
        }
        .info-value {
            color: #4068fc;
            font-weight: bold;
        }
        .filters-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .filter-label {
            color: #666;
            font-weight: 500;
        }
        .filter-input {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: inherit;
        }
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }
        .attendance-table th {
            background: #4068fc;
            color: white;
            padding: 1rem;
            text-align: center;
            font-weight: 500;
        }
        .attendance-table td {
            padding: 0.8rem;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        .attendance-table tr:last-child td {
            border-bottom: none;
        }
        .weekend {
            background: #f8f9fa;
        }
        .status-present {
            color: #28a745;
        }
        .status-late {
            color: #ffc107;
        }
        .status-excused {
            color: #17a2b8;
        }
        .attendance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .summary-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }
        .summary-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4068fc;
            margin: 0.5rem 0;
        }
        .summary-label {
            color: #666;
            font-weight: 500;
        }
        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
            max-width: 400px;
            margin: 0 auto 2rem auto;
        }
        .icons-legend {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .legend-icon {
            font-size: 1.2rem;
        }
        .legend-text {
            color: #666;
            font-size: 0.9rem;
        }
        .export-btn {
            background: #4068fc;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }
        .export-btn:hover {
            background: #43cea2;
        }
        @media (max-width: 768px) {
            .student-info {
                flex-direction: column;
                gap: 1rem;
            }
            .filters-container {
                flex-direction: column;
            }
            .attendance-table {
                display: block;
                overflow-x: auto;
            }
        }
        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }
        .calendar-table th {
            background: #4068fc;
            color: white;
            padding: 1rem;
            text-align: center;
            font-weight: 500;
        }
        .calendar-table td {
            padding: 1rem;
            text-align: center;
            border: 1px solid #eee;
            position: relative;
            min-width: 80px;
            height: 80px;
            vertical-align: top;
        }
        .calendar-table .weekend {
            background: #f8f9fa;
        }
        .calendar-table .day-number {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        .calendar-table .status-icon {
            font-size: 1.5rem;
            margin-top: 1.5rem;
        }
        .calendar-table .empty-cell {
            background: #f8f9fa;
        }
        .calendar-table .today {
            background: rgba(64, 104, 252, 0.1);
            border: 2px solid #4068fc;
        }
        .calendar-table .today .day-number {
            color: #4068fc;
            font-weight: bold;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .calendar-title {
            font-size: 1.2rem;
            color: #4068fc;
            font-weight: bold;
        }
        .calendar-nav {
            display: flex;
            gap: 1rem;
        }
        .calendar-nav-btn {
            background: #4068fc;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
        }
        .calendar-nav-btn:hover {
            background: #43cea2;
        }
        .calendar-nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="student-header">
        <button class="sidebar-toggle" id="sidebarToggle" title="ÿ•ÿ∫ŸÑÿßŸÇ/ŸÅÿ™ÿ≠ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©">&#9776;</button>
        <div class="student-header-left">
            <span class="student-title">ÿßŸÑÿ≠ÿ∂Ÿàÿ±</span>
        </div>
        <div class="student-header-right">
            <span class="student-notifications" title="ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™" style="cursor:pointer; font-size: 1.3em; margin: 0 8px; position: relative;">
                üîî
                <span id="notification-count" style="display:none; position: absolute; top: -8px; right: -8px; background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.8em; min-width: 18px; text-align: center;">0</span>
            </span>
            <span class="student-messages" title="ÿßŸÑŸÜŸÇÿßÿ¥ÿßÿ™" style="cursor:pointer; font-size: 1.3em; margin-left: 8px; position: relative;" onclick="window.location.href='Student_Discussion.html'">
                üí¨
                <span id="message-count" style="display:none; position: absolute; top: -8px; right: -8px; background: #2196f3; color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.8em; min-width: 18px; text-align: center;">0</span>
            </span>
            <span class="student-user">ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå ÿßŸÑÿ∑ÿßŸÑÿ®</span>
            <button class="logout-btn">ÿ™ÿ≥ÿ¨ŸäŸÑ ÿÆÿ±Ÿàÿ¨</button>
        </div>
    </div>
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    <div class="student-sidebar">
        <h2 class="sidebar-title">ŸÖÿØÿßÿ±ŸêŸÉ</h2>
        <button class="sidebar-toggle sidebar-toggle-inside" id="sidebarToggleInside" title="ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©" style="display:none">&#10005;</button>
        <ul>
            <li><a href="StudentDashboard.html" id="dashboard-link"><span class="icon">üè†</span> ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ </a></li>
            <li><a href="Student_Lessons.html" id="courses-link"><span class="icon">üìö</span> ÿØÿ±Ÿàÿ≥Ÿä </a></li>
            <li><a href="Student_Homework.html" id="assignments-link"><span class="icon">üìù</span> Ÿàÿßÿ¨ÿ®ÿßÿ™Ÿä </a></li>
            <li><a href="Student_Grades.html" id="grades-link"><span class="icon">üìä</span> ÿØÿ±ÿ¨ÿßÿ™Ÿä</a></li>
            <li><a href="Student_Attendance.html" id="attendance-link" class="active"><span class="icon">üìÖ</span> ÿßŸÑÿ≠ÿ∂Ÿàÿ±</a></li>
            <li><a href="Student_Courses.html" id="courses-link"><span class="icon">üë®‚Äçüè´</span> ÿßŸÑÿØŸàÿ±ÿßÿ™ </a></li>
        </ul>
    </div>
    <div class="student-main" id="student-main-content">
        <div class="attendance-header">
            <span class="attendance-icon">üìÖ</span>
            <span class="attendance-title">ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ±</span>
        </div>

        <div class="student-info">
            <div class="info-item">
                <span class="info-label">ÿßÿ≥ŸÖ ÿßŸÑÿ∑ÿßŸÑÿ®:</span>
                <span class="info-value" id="student-name">ÿ≥ÿ±ÿßÿ¨ ÿßŸÑŸáÿßÿØŸä ÿπÿ±Ÿäÿ®Ÿä</span>
            </div>
            <div class="info-item">
                <span class="info-label">ÿßŸÑÿµŸÅ:</span>
                <span class="info-value" id="student-grade">ÿßŸÑÿ≥ÿßÿØÿ≥</span>
            </div>
            <div class="info-item">
                <span class="info-label">ÿßŸÑŸÅÿµŸÑ:</span>
                <span class="info-value" id="student-class">ÿ£</span>
            </div>
        </div>

        <div class="filters-container">
            <div class="filter-group">
                <label class="filter-label">ÿßŸÑÿ¥Ÿáÿ±:</label>
                <select class="filter-input" id="month-filter">
                    <option value="9-2024">ÿ≥ÿ®ÿ™ŸÖÿ®ÿ± 2024</option>
                    <option value="10-2024">ÿ£ŸÉÿ™Ÿàÿ®ÿ± 2024</option>
                    <option value="11-2024">ŸÜŸàŸÅŸÖÿ®ÿ± 2024</option>
                    <option value="12-2024">ÿØŸäÿ≥ŸÖÿ®ÿ± 2024</option>
                    <option value="1-2025">ŸäŸÜÿßŸäÿ± 2025</option>
                    <option value="2-2025">ŸÅÿ®ÿ±ÿßŸäÿ± 2025</option>
                    <option value="3-2025">ŸÖÿßÿ±ÿ≥ 2025</option>
                    <option value="4-2025">ÿ£ÿ®ÿ±ŸäŸÑ 2025</option>
                    <option value="5-2025" selected>ŸÖÿßŸäŸà 2025</option>
                </select>
            </div>
        </div>

        <div class="calendar-header">
            <div class="calendar-title" id="calendar-title">ŸÖÿßŸäŸà 2025</div>
            <div class="calendar-nav">
                <button class="calendar-nav-btn" onclick="previousMonth()" id="prev-month-btn">ÿßŸÑÿ¥Ÿáÿ± ÿßŸÑÿ≥ÿßÿ®ŸÇ</button>
                <button class="calendar-nav-btn" onclick="nextMonth()" id="next-month-btn">ÿßŸÑÿ¥Ÿáÿ± ÿßŸÑÿ™ÿßŸÑŸä</button>
            </div>
        </div>

        <div class="icons-legend">
            <div class="legend-item">
                <span class="legend-icon">‚úÖ</span>
                <span class="legend-text">ÿ≠ÿßÿ∂ÿ±</span>
            </div>
            <div class="legend-item">
                <span class="legend-icon">‚ùå</span>
                <span class="legend-text">ÿ∫ÿßÿ¶ÿ®</span>
            </div>
            <div class="legend-item">
                <span class="legend-icon">‚è∞</span>
                <span class="legend-text">ŸÖÿ™ÿ£ÿÆÿ±</span>
            </div>
            <div class="legend-item">
                <span class="legend-icon">üìÑ</span>
                <span class="legend-text">ÿ®ÿπÿ∞ÿ±</span>
            </div>
        </div>

        <table class="calendar-table">
            <thead>
                <tr>
                    <th>ÿßŸÑÿ£ÿ≠ÿØ</th>
                    <th>ÿßŸÑÿ•ÿ´ŸÜŸäŸÜ</th>
                    <th>ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°</th>
                    <th>ÿßŸÑÿ£ÿ±ÿ®ÿπÿßÿ°</th>
                    <th>ÿßŸÑÿÆŸÖŸäÿ≥</th>
                    <th>ÿßŸÑÿ¨ŸÖÿπÿ©</th>
                    <th>ÿßŸÑÿ≥ÿ®ÿ™</th>
                </tr>
            </thead>
            <tbody id="calendar-body">
                <!-- ÿ≥Ÿäÿ™ŸÖ ÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿØŸäŸÜÿßŸÖŸäŸÉŸäÿßŸã -->
            </tbody>
        </table>

        <button class="export-btn" onclick="exportToPDF()">
            <span>üìÑ</span>
            <span>ÿ™ÿµÿØŸäÿ± ÿ•ŸÑŸâ PDF</span>
        </button>

        <div class="attendance-summary">
            <div class="summary-card">
                <div class="summary-value" id="present-days">0</div>
                <div class="summary-label">ÿ£ŸäÿßŸÖ ÿßŸÑÿ≠ÿ∂Ÿàÿ±</div>
            </div>
            <div class="summary-card">
                <div class="summary-value" id="absent-days">0</div>
                <div class="summary-label">ÿ£ŸäÿßŸÖ ÿßŸÑÿ∫Ÿäÿßÿ®</div>
            </div>
            <div class="summary-card">
                <div class="summary-value" id="late-days">0</div>
                <div class="summary-label">ÿ£ŸäÿßŸÖ ÿßŸÑÿ™ÿ£ÿÆŸäÿ±</div>
            </div>
            <div class="summary-card">
                <div class="summary-value" id="excused-days">0</div>
                <div class="summary-label">ÿ£ŸäÿßŸÖ ÿßŸÑÿ∫Ÿäÿßÿ® ÿ®ÿπÿ∞ÿ±</div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="attendance-chart"></canvas>
        </div>
    </div>
    <script src="Script.js"></script>
    <script>
        /**
         * ÿ™Ÿàÿ´ŸäŸÇ ŸáŸäŸÉŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸàÿßŸÑŸÄ API ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ© ŸÑŸÑŸÄ Backend Team
         * 
         * 1. ŸáŸäŸÉŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®:
         * 
         * ÿ£. ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ÿßŸÑÿ®:
         * {
         *     id: string,          // ŸÖÿπÿ±ŸÅ ÿßŸÑÿ∑ÿßŸÑÿ®
         *     name: string,        // ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑÿ´ŸÑÿßÿ´Ÿä ŸÑŸÑÿ∑ÿßŸÑÿ®
         *     grade: string,       // ÿßŸÑÿµŸÅ ÿßŸÑÿØÿ±ÿßÿ≥Ÿä
         *     class: string        // ÿßŸÑŸÅÿµŸÑ
         * }
         * 
         * ÿ®. ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±:
         * {
         *     date: string,        // ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ≠ÿ∂Ÿàÿ± (YYYY-MM-DD)
         *     status: string,      // ÿ≠ÿßŸÑÿ© ÿßŸÑÿ≠ÿ∂Ÿàÿ± (present, absent, late, excused)
         *     recorded_by: string, // ŸÖÿπÿ±ŸÅ ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ
         *     recorded_at: string, // ŸàŸÇÿ™ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ (ISO 8601)
         *     notes: string        // ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©
         * }
         * 
         * 2. ŸÜŸÇÿßÿ∑ ŸÜŸáÿßŸäÿ© API ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©:
         * 
         * ÿ£. ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ÿßŸÑÿ®:
         * GET /api/students/{studentId}
         * Response: ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ÿßŸÑÿ®
         * 
         * ÿ®. ÿ¨ŸÑÿ® ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ±:
         * GET /api/attendance/{studentId}
         * Query Parameters:
         *   - month: ÿ±ŸÇŸÖ ÿßŸÑÿ¥Ÿáÿ± (1-12)
         *   - year: ÿßŸÑÿ≥ŸÜÿ©
         * Response: ŸÖÿµŸÅŸàŸÅÿ© ŸÖŸÜ ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
         * 
         * ÿ¨. ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ≠ÿ∂Ÿàÿ± ÿ¨ÿØŸäÿØ:
         * POST /api/attendance
         * Body: ÿ≥ÿ¨ŸÑ ÿ≠ÿ∂Ÿàÿ± ÿ¨ÿØŸäÿØ
         * Response: ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ÿßŸÑŸÖÿ≠ÿØÿ´
         * 
         * ÿØ. ÿ™ÿ≠ÿØŸäÿ´ ÿ≥ÿ¨ŸÑ ÿ≠ÿ∂Ÿàÿ±:
         * PUT /api/attendance/{attendanceId}
         * Body: ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´
         * Response: ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ÿßŸÑŸÖÿ≠ÿØÿ´
         * 
         * 3. ŸÖÿ™ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ:
         * - Ÿäÿ¨ÿ® ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµŸÑÿßÿ≠Ÿäÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÇÿ®ŸÑ ÿ£Ÿä ÿπŸÖŸÑŸäÿ©
         * - ÿ™ÿ¥ŸÅŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠ÿ≥ÿßÿ≥ÿ©
         * - ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿØÿÆŸÑÿ©
         * 
         * 4. ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ŸáÿßŸÖÿ©:
         * - Ÿäÿ¨ÿ® ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ£ŸÜ ÿßŸÑÿ™Ÿàÿßÿ±ŸäÿÆ ÿ∂ŸÖŸÜ ÿßŸÑÿ≥ŸÜÿ© ÿßŸÑÿØÿ±ÿßÿ≥Ÿäÿ©
         * - Ÿäÿ¨ÿ® ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿπÿØŸÖ ÿ™ŸÉÿ±ÿßÿ± ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑŸÜŸÅÿ≥ ÿßŸÑŸäŸàŸÖ
         * - Ÿäÿ¨ÿ® ÿ™ÿ≥ÿ¨ŸäŸÑ ŸàŸÇÿ™ Ÿàÿ™ÿßÿ±ŸäÿÆ ŸÉŸÑ ÿπŸÖŸÑŸäÿ© ÿ™ÿπÿØŸäŸÑ
         * - Ÿäÿ¨ÿ® ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿ≥ÿ¨ŸÑ ŸÑŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™ (audit log)
         */

        // ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© (ŸäŸÖŸÉŸÜ ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑŸáÿß ÿ®ÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ ÿßŸÑÿ®ÿßŸÉ ÿ•ŸÜÿØ)
        function generateMockAttendanceData() {
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            const attendance = [];
            let absentDay = Math.floor(Math.random() * daysInMonth) + 1;
            let lateDay = Math.floor(Math.random() * daysInMonth) + 1;
            let excusedDay = Math.floor(Math.random() * daysInMonth) + 1;
            
            // ÿ™ÿ¨ŸÜÿ® ÿ™ŸÉÿ±ÿßÿ± ÿßŸÑÿ£ŸäÿßŸÖ
            while (lateDay === absentDay) {
                lateDay = Math.floor(Math.random() * daysInMonth) + 1;
            }
            while (excusedDay === absentDay || excusedDay === lateDay) {
                excusedDay = Math.floor(Math.random() * daysInMonth) + 1;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                const dayName = date.toLocaleDateString('ar-SA', { weekday: 'long' });
                
                // ÿ™ÿÆÿ∑Ÿä ÿ£ŸäÿßŸÖ ÿßŸÑÿπÿ∑ŸÑÿ© (ÿßŸÑÿ¨ŸÖÿπÿ© ŸàÿßŸÑÿ≥ÿ®ÿ™)
                if (dayName === 'ÿßŸÑÿ¨ŸÖÿπÿ©' || dayName === 'ÿßŸÑÿ≥ÿ®ÿ™') {
                    continue;
                }

                let status = 'present';
                if (day === absentDay) {
                    status = 'absent';
                } else if (day === lateDay) {
                    status = 'late';
                } else if (day === excusedDay) {
                    status = 'excused';
                }
                
                const record = {
                    date: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`,
                    status: status,
                    recorded_by: "ADM001",
                    recorded_at: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}T08:00:00`,
                    notes: getStatusNote(status)
                };
                
                attendance.push(record);
            }
            
            return {
                student: {
                    id: "STU001",
                    name: "ÿ≥ÿ±ÿßÿ¨ ÿßŸÑŸáÿßÿØŸä ÿπÿ±Ÿäÿ®Ÿä",
                    grade: "ÿßŸÑÿ≥ÿßÿØÿ≥",
                    class: "ÿ£"
                },
                attendance: attendance
            };
        }

        function getStatusNote(status) {
            const notes = {
                present: "",
                late: "ÿ™ÿ£ÿÆÿ± " + Math.floor(Math.random() * 20 + 5) + " ÿØŸÇÿßÿ¶ŸÇ",
                excused: ["ÿπÿ∞ÿ± ÿ∑ÿ®Ÿä", "ÿπÿ∞ÿ± ÿπÿßÿ¶ŸÑŸä", "ŸÖŸàÿπÿØ ÿ∑ÿ®Ÿäÿ®", "ŸÖŸÜÿßÿ≥ÿ®ÿ© ÿÆÿßÿµÿ©"][Math.floor(Math.random() * 4)],
                absent: "ÿ∫Ÿäÿßÿ® ÿ®ÿØŸàŸÜ ÿπÿ∞ÿ±"
            };
            return notes[status];
        }

        const mockAttendanceData = generateMockAttendanceData();

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ∑ÿßŸÑÿ®
        document.getElementById('student-name').textContent = mockAttendanceData.student.name;
        document.getElementById('student-grade').textContent = mockAttendanceData.student.grade;
        document.getElementById('student-class').textContent = mockAttendanceData.student.class;

        /**
         * ÿØÿßŸÑÿ© ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸÇŸàŸäŸÖ
         * 
         * ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ŸÑŸÑŸÄ Backend:
         * - Ÿäÿ¨ÿ® ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ÿ®ÿ∑ŸÑÿ® API
         * - Ÿäÿ¨ÿ® ÿßŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿ≠ÿßŸÑÿßÿ™ ÿßŸÑÿÆÿ∑ÿ£ (ŸÖÿ´ŸÑ ÿßŸÜŸÇÿ∑ÿßÿπ ÿßŸÑÿßÿ™ÿµÿßŸÑ)
         * - Ÿäÿ¨ÿ® ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ§ÿ¥ÿ± ÿ™ÿ≠ŸÖŸäŸÑ ÿ£ÿ´ŸÜÿßÿ° ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
         * - Ÿäÿ¨ÿ® ÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ§ŸÇÿ™ÿßŸã ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿØÿßÿ°
         */
        function updateCalendar() {
            const tbody = document.getElementById('calendar-body');
            tbody.innerHTML = '';

            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const startingDay = firstDay.getDay();
            const totalDays = lastDay.getDate();
            const today = new Date();

            // ÿ≠ÿ≥ÿßÿ® ÿπÿØÿØ ÿßŸÑÿµŸÅŸàŸÅ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©
            const totalRows = Math.ceil((startingDay + totalDays) / 7);

            // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿµŸÅŸàŸÅ
            for (let row = 0; row < totalRows; row++) {
                const tr = document.createElement('tr');
                
                // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿÆŸÑÿßŸäÿß ŸÅŸä ŸÉŸÑ ÿµŸÅ
                for (let col = 0; col < 7; col++) {
                    const td = document.createElement('td');
                    const dayNumber = row * 7 + col - startingDay + 1;

                    if (dayNumber > 0 && dayNumber <= totalDays) {
                        // ÿ•ŸÜÿ¥ÿßÿ° ÿÆŸÑŸäÿ© ŸÑŸÑŸäŸàŸÖ
                        const currentDate = new Date(currentYear, currentMonth, dayNumber);
                        const dayName = currentDate.toLocaleDateString('ar-SA', { weekday: 'long' });

                        // ÿ™ŸÖŸäŸäÿ≤ ÿßŸÑŸäŸàŸÖ ÿßŸÑÿ≠ÿßŸÑŸä
                        if (currentDate.toDateString() === today.toDateString()) {
                            td.classList.add('today');
                        }

                        // ÿ™ŸÖŸäŸäÿ≤ ÿπÿ∑ŸÑÿ© ŸÜŸáÿßŸäÿ© ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ
                        if (dayName === 'ÿßŸÑÿ¨ŸÖÿπÿ©' || dayName === 'ÿßŸÑÿ≥ÿ®ÿ™') {
                            td.classList.add('weekend');
                        }

                        // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ŸÇŸÖ ÿßŸÑŸäŸàŸÖ
                        const dayNumberDiv = document.createElement('div');
                        dayNumberDiv.className = 'day-number';
                        dayNumberDiv.textContent = dayNumber;
                        td.appendChild(dayNumberDiv);

                        // ÿ•ÿ∂ÿßŸÅÿ© ÿ≠ÿßŸÑÿ© ÿßŸÑÿ≠ÿ∂Ÿàÿ±
                        const attendanceRecord = mockAttendanceData.attendance.find(
                            a => {
                                const recordDate = new Date(a.date);
                                return recordDate.getDate() === dayNumber &&
                                       recordDate.getMonth() === currentMonth &&
                                       recordDate.getFullYear() === currentYear;
                            }
                        );

                        if (attendanceRecord) {
                            const statusIcon = document.createElement('div');
                            statusIcon.className = 'status-icon';
                            
                            const statusIconMap = {
                                present: '‚úÖ',
                                absent: '‚ùå',
                                late: '‚è∞',
                                excused: 'üìÑ'
                            };

                            const statusClassMap = {
                                present: 'status-present',
                                absent: 'status-absent',
                                late: 'status-late',
                                excused: 'status-excused'
                            };

                            statusIcon.textContent = statusIconMap[attendanceRecord.status];
                            statusIcon.classList.add(statusClassMap[attendanceRecord.status]);
                            td.appendChild(statusIcon);
                        }
                    } else {
                        // ÿ•ŸÜÿ¥ÿßÿ° ÿÆŸÑŸäÿ© ŸÅÿßÿ±ÿ∫ÿ©
                        td.classList.add('empty-cell');
                    }
                    
                    tr.appendChild(td);
                }
                
                tbody.appendChild(tr);
            }

            updateCalendarTitle();
            updateNavigationButtons();
            updateMonthFilter();
        }

        /**
         * ÿØÿßŸÑÿ© ÿ™ÿ≠ÿØŸäÿ´ ŸÖŸÑÿÆÿµ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
         * 
         * ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ŸÑŸÑŸÄ Backend:
         * - Ÿäÿ¨ÿ® ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ŸÅŸä ÿßŸÑŸÄ Backend
         * - Ÿäÿ¨ÿ® ÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ŸÖÿ§ŸÇÿ™ÿßŸã
         * - Ÿäÿ¨ÿ® ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
         */
        function updateAttendanceSummary() {
            // ÿ™ÿµŸÅŸäÿ© ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑŸÑÿ¥Ÿáÿ± ÿßŸÑÿ≠ÿßŸÑŸä ŸÅŸÇÿ∑
            const currentMonthAttendance = mockAttendanceData.attendance.filter(record => {
                const recordDate = new Date(record.date);
                return recordDate.getMonth() === currentMonth && 
                       recordDate.getFullYear() === currentYear;
            });

            const summary = {
                present: currentMonthAttendance.filter(a => a.status === "present").length,
                absent: currentMonthAttendance.filter(a => a.status === "absent").length,
                late: currentMonthAttendance.filter(a => a.status === "late").length,
                excused: currentMonthAttendance.filter(a => a.status === "excused").length
            };

            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ŸÅŸä ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™
            document.getElementById('present-days').textContent = summary.present;
            document.getElementById('absent-days').textContent = summary.absent;
            document.getElementById('late-days').textContent = summary.late;
            document.getElementById('excused-days').textContent = summary.excused;

            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ®ŸäÿßŸÜŸä
            const ctx = document.getElementById('attendance-chart').getContext('2d');
            
            if (window.attendanceChart) {
                window.attendanceChart.destroy();
            }

            window.attendanceChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['ÿ≠ÿßÿ∂ÿ±', 'ÿ∫ÿßÿ¶ÿ®', 'ŸÖÿ™ÿ£ÿÆÿ±', 'ÿ®ÿπÿ∞ÿ±'],
                    datasets: [{
                        data: [summary.present, summary.absent, summary.late, summary.excused],
                        backgroundColor: ['#28a745', '#dc3545', '#ffc107', '#17a2b8']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: `ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± - ${getMonthName(currentMonth)} ${currentYear}`,
                            font: {
                                size: 16
                            }
                        }
                    }
                }
            });
        }

        // ÿØÿßŸÑÿ© ŸÖÿ≥ÿßÿπÿØÿ© ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßÿ≥ŸÖ ÿßŸÑÿ¥Ÿáÿ±
        function getMonthName(month) {
            const monthNames = [
                "ŸäŸÜÿßŸäÿ±", "ŸÅÿ®ÿ±ÿßŸäÿ±", "ŸÖÿßÿ±ÿ≥", "ÿ£ÿ®ÿ±ŸäŸÑ", "ŸÖÿßŸäŸà", "ŸäŸàŸÜŸäŸà",
                "ŸäŸàŸÑŸäŸà", "ÿ£ÿ∫ÿ≥ÿ∑ÿ≥", "ÿ≥ÿ®ÿ™ŸÖÿ®ÿ±", "ÿ£ŸÉÿ™Ÿàÿ®ÿ±", "ŸÜŸàŸÅŸÖÿ®ÿ±", "ÿØŸäÿ≥ŸÖÿ®ÿ±"
            ];
            return monthNames[month];
        }

        /**
         * ÿØÿßŸÑÿ© ÿ™ÿµÿØŸäÿ± ÿ•ŸÑŸâ PDF
         */
        function exportToPDF() {
            try {
                // ÿ•ŸÜÿ¥ÿßÿ° ÿπŸÜÿµÿ± ŸÖÿ§ŸÇÿ™ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ£ŸàŸÑŸâ
                const firstPageDiv = document.createElement('div');
                firstPageDiv.style.direction = 'rtl';
                firstPageDiv.style.padding = '20px';
                firstPageDiv.style.backgroundColor = 'white';
                firstPageDiv.style.width = '800px';
                firstPageDiv.style.margin = '0 auto';
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ£ŸàŸÑŸâ
                firstPageDiv.innerHTML = `
                    <h1 style="text-align: center; color: #4068fc; margin-bottom: 30px;">ŸÖÿØÿßÿ±ŸÉ - ŸÉÿ¥ŸÅ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸàÿßŸÑÿ∫Ÿäÿßÿ®</h1>
                    <div style="margin: 20px 0; font-size: 16px;">
                        <p><strong>ÿßŸÑÿ∑ÿßŸÑÿ®:</strong> ${mockAttendanceData.student.name}</p>
                        <p><strong>ÿßŸÑÿµŸÅ:</strong> ${mockAttendanceData.student.grade}</p>
                        <p><strong>ÿßŸÑŸÅÿµŸÑ:</strong> ${mockAttendanceData.student.class}</p>
                        <p><strong>ÿßŸÑÿ¥Ÿáÿ±:</strong> ${getMonthName(currentMonth)} ${currentYear}</p>
                    </div>
                `;

                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ¨ÿØÿßŸàŸÑ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ£ŸàŸÑŸâ
                const currentMonthAttendance = mockAttendanceData.attendance.filter(record => {
                    const recordDate = new Date(record.date);
                    return recordDate.getMonth() === currentMonth && 
                           recordDate.getFullYear() === currentYear;
                });

                const summary = {
                    present: currentMonthAttendance.filter(a => a.status === "present").length,
                    absent: currentMonthAttendance.filter(a => a.status === "absent").length,
                    late: currentMonthAttendance.filter(a => a.status === "late").length,
                    excused: currentMonthAttendance.filter(a => a.status === "excused").length
                };

                firstPageDiv.innerHTML += `
                    <div style="margin-bottom: 30px;">
                        <h2 style="color: #4068fc; margin-bottom: 15px;">ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±</h2>
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                            <tr style="background-color: #4068fc; color: white;">
                                <th style="padding: 12px; border: 1px solid #ddd;">ŸÜŸàÿπ ÿßŸÑÿ≠ÿ∂Ÿàÿ±</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">ÿπÿØÿØ ÿßŸÑÿ£ŸäÿßŸÖ</th>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">ÿ≠ÿßÿ∂ÿ±</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.present}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">ÿ∫ÿßÿ¶ÿ®</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.absent}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">ŸÖÿ™ÿ£ÿÆÿ±</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.late}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">ÿ®ÿπÿ∞ÿ±</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${summary.excused}</td>
                            </tr>
                        </table>
                    </div>
                `;

                // ÿ•ŸÜÿ¥ÿßÿ° ÿπŸÜÿµÿ± ŸÖÿ§ŸÇÿ™ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©
                const secondPageDiv = document.createElement('div');
                secondPageDiv.style.direction = 'rtl';
                secondPageDiv.style.padding = '20px';
                secondPageDiv.style.backgroundColor = 'white';
                secondPageDiv.style.width = '800px';
                secondPageDiv.style.margin = '0 auto';

                // ÿ™ŸÇÿ≥ŸäŸÖ ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
                const statusMap = {
                    'present': 'ÿ≠ÿßÿ∂ÿ±',
                    'absent': 'ÿ∫ÿßÿ¶ÿ®',
                    'late': 'ŸÖÿ™ÿ£ÿÆÿ±',
                    'excused': 'ÿ®ÿπÿ∞ÿ±'
                };

                // ÿßŸÑÿ£ŸäÿßŸÖ ŸÖŸÜ 1 ÿ•ŸÑŸâ 10
                const firstPageRows = currentMonthAttendance
                    .filter(record => {
                        const date = new Date(record.date);
                        return date.getDate() <= 10;
                    })
                    .map(record => {
                        const date = new Date(record.date);
                        return `
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getDate()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${getMonthName(date.getMonth())}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getFullYear()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.status === 'holiday' ? '-' : statusMap[record.status]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.notes || '-'}</td>
                            </tr>
                        `;
                    }).join('');

                // ÿ®ÿßŸÇŸä ÿßŸÑÿ£ŸäÿßŸÖ
                const secondPageRows = currentMonthAttendance
                    .filter(record => {
                        const date = new Date(record.date);
                        return date.getDate() > 10;
                    })
                    .map(record => {
                        const date = new Date(record.date);
                        return `
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getDate()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${getMonthName(date.getMonth())}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${date.getFullYear()}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.status === 'holiday' ? '-' : statusMap[record.status]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${record.notes || '-'}</td>
                            </tr>
                        `;
                    }).join('');

                // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸàŸÑ ÿßŸÑÿ£ŸäÿßŸÖ ŸÖŸÜ 1 ÿ•ŸÑŸâ 10 ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ£ŸàŸÑŸâ
                firstPageDiv.innerHTML += `
                    <div style="margin-bottom: 30px;">
                        <h2 style="color: #4068fc; margin-bottom: 15px;">ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± (1-10)</h2>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr style="background-color: #4068fc; color: white;">
                                <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑŸäŸàŸÖ</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑÿ¥Ÿáÿ±</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑÿ≥ŸÜÿ©</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑÿ≠ÿßŸÑÿ©</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™</th>
                            </tr>
                            ${firstPageRows}
                        </table>
                    </div>
                `;

                // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸàŸÑ ÿ®ÿßŸÇŸä ÿßŸÑÿ£ŸäÿßŸÖ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©
                secondPageDiv.innerHTML = `
                    <h2 style="color: #4068fc; margin-bottom: 15px;">ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± (11-31)</h2>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="background-color: #4068fc; color: white;">
                            <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑŸäŸàŸÖ</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑÿ¥Ÿáÿ±</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑÿ≥ŸÜÿ©</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">ÿßŸÑÿ≠ÿßŸÑÿ©</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™</th>
                        </tr>
                        ${secondPageRows}
                    </table>
                    <div style="text-align: center; margin-top: 30px; color: #666; font-size: 14px;">
                        ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° Ÿáÿ∞ÿß ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ŸÅŸä ${new Date().toLocaleDateString('ar')}
                    </div>
                `;

                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿπŸÜÿßÿµÿ± ÿ•ŸÑŸâ ÿßŸÑÿµŸÅÿ≠ÿ©
                document.body.appendChild(firstPageDiv);
                document.body.appendChild(secondPageDiv);

                // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ£ŸàŸÑŸâ ÿ•ŸÑŸâ ÿµŸàÿ±ÿ©
                html2canvas(firstPageDiv, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    windowWidth: firstPageDiv.scrollWidth,
                    windowHeight: firstPageDiv.scrollHeight
                }).then(canvas1 => {
                    // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ© ÿ•ŸÑŸâ ÿµŸàÿ±ÿ©
                    html2canvas(secondPageDiv, {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        windowWidth: secondPageDiv.scrollWidth,
                        windowHeight: secondPageDiv.scrollHeight
                    }).then(canvas2 => {
                        const { jsPDF } = window.jspdf;
                        const pdf = new jsPDF('p', 'mm', 'a4');
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        
                        // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ£ŸàŸÑŸâ
                        const imgData1 = canvas1.toDataURL('image/png');
                        const pdfHeight1 = (canvas1.height * pdfWidth) / canvas1.width;
                        pdf.addImage(imgData1, 'PNG', 0, 0, pdfWidth, pdfHeight1);
                        
                        // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©
                        const imgData2 = canvas2.toDataURL('image/png');
                        const pdfHeight2 = (canvas2.height * pdfWidth) / canvas2.width;
                        pdf.addPage();
                        pdf.addImage(imgData2, 'PNG', 0, 0, pdfWidth, pdfHeight2);

                        // ÿ≠ŸÅÿ∏ ÿßŸÑŸÖŸÑŸÅ
                        pdf.save(`ÿ≠ÿ∂Ÿàÿ±_${mockAttendanceData.student.name}_${getMonthName(currentMonth)}_${currentYear}.pdf`);
                        
                        // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑŸÖÿ§ŸÇÿ™ÿ©
                        document.body.removeChild(firstPageDiv);
                        document.body.removeChild(secondPageDiv);
                    });
                });
            } catch (error) {
                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ŸÜÿ¥ÿßÿ° ŸÖŸÑŸÅ PDF:', error);
                alert('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ•ŸÜÿ¥ÿßÿ° ŸÖŸÑŸÅ PDF. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.');
            }
        }

        // ÿ™ÿπÿ±ŸäŸÅ ÿ≠ÿØŸàÿØ ÿßŸÑÿ≥ŸÜÿ© ÿßŸÑÿØÿ±ÿßÿ≥Ÿäÿ©
        const academicYear = {
            start: { month: 8, year: 2024 }, // ÿ≥ÿ®ÿ™ŸÖÿ®ÿ± 2024
            end: { month: 4, year: 2025 }    // ŸÖÿßŸäŸà 2025
        };

        let currentMonth = 4; // ŸÖÿßŸäŸà (0-11)
        let currentYear = 2025;

        // ÿ™ÿ≠ÿØŸäÿ´ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿ™ŸÇŸàŸäŸÖ
        function updateCalendarTitle() {
            const monthNames = [
                "ŸäŸÜÿßŸäÿ±", "ŸÅÿ®ÿ±ÿßŸäÿ±", "ŸÖÿßÿ±ÿ≥", "ÿ£ÿ®ÿ±ŸäŸÑ", "ŸÖÿßŸäŸà", "ŸäŸàŸÜŸäŸà",
                "ŸäŸàŸÑŸäŸà", "ÿ£ÿ∫ÿ≥ÿ∑ÿ≥", "ÿ≥ÿ®ÿ™ŸÖÿ®ÿ±", "ÿ£ŸÉÿ™Ÿàÿ®ÿ±", "ŸÜŸàŸÅŸÖÿ®ÿ±", "ÿØŸäÿ≥ŸÖÿ®ÿ±"
            ];
            document.getElementById('calendar-title').textContent = 
                `${monthNames[currentMonth]} ${currentYear}`;
        }

        // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ≠ÿØŸàÿØ ÿßŸÑÿ≥ŸÜÿ© ÿßŸÑÿØÿ±ÿßÿ≥Ÿäÿ©
        function isWithinAcademicYear(month, year) {
            if (year < academicYear.start.year || year > academicYear.end.year) {
                return false;
            }
            if (year === academicYear.start.year && month < academicYear.start.month) {
                return false;
            }
            if (year === academicYear.end.year && month > academicYear.end.month) {
                return false;
            }
            return true;
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ŸÜŸÇŸÑ
        function updateNavigationButtons() {
            const prevButton = document.getElementById('prev-month-btn');
            const nextButton = document.getElementById('next-month-btn');
            
            prevButton.disabled = !isWithinAcademicYear(currentMonth - 1, currentYear);
            nextButton.disabled = !isWithinAcademicYear(currentMonth + 1, currentYear);
        }

        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿßŸÑÿ¥Ÿáÿ± ÿßŸÑÿ≥ÿßÿ®ŸÇ
        function previousMonth() {
            if (currentMonth === 0) {
                currentMonth = 11;
                currentYear--;
            } else {
                currentMonth--;
            }
            if (isWithinAcademicYear(currentMonth, currentYear)) {
                updateCalendar();
                updateMonthFilter();
            }
        }

        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿßŸÑÿ¥Ÿáÿ± ÿßŸÑÿ™ÿßŸÑŸä
        function nextMonth() {
            if (currentMonth === 11) {
                currentMonth = 0;
                currentYear++;
            } else {
                currentMonth++;
            }
            if (isWithinAcademicYear(currentMonth, currentYear)) {
                updateCalendar();
                updateMonthFilter();
            }
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÅŸÑÿ™ÿ± ÿßŸÑÿ¥Ÿáÿ±
        function updateMonthFilter() {
            const monthFilter = document.getElementById('month-filter');
            const value = `${currentMonth + 1}-${currentYear}`;
            monthFilter.value = value;
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸÇŸàŸäŸÖ ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ¥Ÿáÿ± ŸÖŸÜ ÿßŸÑŸÅŸÑÿ™ÿ±
        document.getElementById('month-filter').addEventListener('change', function() {
            const [month, year] = this.value.split('-');
            const newMonth = parseInt(month) - 1;
            const newYear = parseInt(year);
            if (isWithinAcademicYear(newMonth, newYear)) {
                currentMonth = newMonth;
                currentYear = newYear;
                updateCalendar();
                updateAttendanceSummary();
            }
        });

        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸÇŸàŸäŸÖ ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
        document.addEventListener('DOMContentLoaded', function() {
            updateCalendar();
            updateAttendanceSummary();
        });
    </script>
</body>
</html>
